{{ define "main" }}
{{ $books := .Site.Data.bookshelves.currentlyreading }}
<div class="d-block d-lg-none">
  <div class="row">
    <div class="col">
      <h6>Listening</h6>
      <div class="pl-0 card">
        <div class="album-info">
          <img src="https://placehold.co/400" alt="Album Art" class="album-art" id="last-fm-art">
          <div class="spinner-overlay" id="spinner-overlay">
            <div class="spinner"></div>
          </div>
          <div>
            <span id="title-load" class="skeleton-box"></span>
            <span id="artist-load" class="skeleton-box"></span>
            <h6 id="last-fm-title"></h6>
            <p id="last-fm-artist" class="text-muted mb-0"></p>
          </div>
        </div>
      </div>
    </div>
    {{ if gt (len $books) 0 }}
    <div class="col-12 mt-3">
      <h6>Reading</h6>
      <div class="pl-0 card">
        <div class="album-info">
          <img src="{{ index $books 0 "cover_url" }}" alt="Album Art" class="album-art">
          <div>
            <h6>{{ index $books 0 "title" }}</h6>
            <p class="text-muted mb-0">{{ index $books 0 "author" }}</p>
          </div>
        </div>
      </div>
    {{ end }}      
    </div>
  </div>
</div>
<hr class="d-block d-lg-none my-5">
<ul class="post-list pl-0">
  {{ $paginator := .Paginate (where .Site.Pages.ByDate.Reverse "Type" "post") (index .Site.Params "archive-paginate" |
  default 25) }}
  {{ range $paginator.Pages }}
  <div class="card {{ range .Params.categories }}{{ . }}{{ end }} mb-5">
    {{ if .Params.images }}
    <div style="max-height: 250px; overflow: hidden;">
      <img src="{{ index .Params.images 0 }}" class="card-img-top w-100" alt="...">
    </div>
    {{ end }}
    <div class="card-body">
      {{- if .Site.Params.categoriesOnPosts -}}
      {{ if isset .Params "categories" }}
        {{ if ne (len .Params.categories) 0 }}
        <div class="mb-2 d-flex flex-wrap">
          {{ range .Params.categories }}
          <h4><span class="badge badge-primary">{{ . }}</span></h4>
          {{ end }}   
        </div>
        {{ end }}
      {{ end }}
      {{ end }}
      {{ if .Title }}
      <h5 class="card-title">{{ .Title }}</h5>
      {{ end }}
      <div class="post-content">
        {{ .Content | truncate 100 }}
      </div>
      <div>
        <a href="{{ .Permalink }}" class="u-url">
          <span class="post-meta">
            <time class="dt-published" datetime="{{ .Date.Format " 2006-01-02 15:04:05 -0700" }}">{{ .Date.Format "Jan 2, 2006" }}</time>
            <i class="fa-solid fa-arrow-right ml-2"></i>
          </span>
        </a>
      </div>
    </div>
  </div>
  {{ end }}
</ul>
{{ if .IsHome }}
<div class="pagination justify-content-center p-0 mb-4">
  {{ partial "pagination" . }}
</div>
{{ end }}
{{ end }}